<template>
    <lightning-modal-header label={stepName}></lightning-modal-header>
    <lightning-modal-body>
  
        <lightning-layout  multiple-rows="true">
            <!--NEW LAYOUT-->

            <lightning-layout-item  padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                <lightning-progress-indicator lwc:if={showProgress} current-step={currentTabValue} type="base" variant="base">
                    <template for:each={stepsArray} for:item="step">
                        <lightning-progress-step label={step.label} value={step.value} key={step.label}></lightning-progress-step>
                    </template>
                </lightning-progress-indicator>
            </lightning-layout-item>

            <!--CONTENT AREA-->
             <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                <lightning-layout  multiple-rows="true">
                   
      
                    <!--STEP CONTENT-->
                                            
                    <lightning-layout-item  padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">

                        <!--SELECT-->
                        <div class="select">
                            <lightning-card title="Select a document to generate">
                                <lightning-layout multiple-rows="true">
                                       
                                        <lightning-layout-item  padding="around-small" size="12" small-device-size="12" medium-device-size="12" large-device-size="12">
                                            
                                            <template for:each={templates} for:item="temp">
                                                <div key={temp.id}>
                                                <lightning-card key={temp.id} class="myCard slds-box"  variant="narrow" >
                                                    <text class="signSubHeader" slot="title" >{temp.Document_Name__c}</text>
                                                    <lightning-button-stateful
                                                    slot="actions"
                                                    id={temp.Id}
                                                    name={temp.Requires_Data_Validation__c}
                                                    value={temp} 
                                                    label-when-off={documentLabel}
                                                    label-when-on={documentLabel}
                                                    icon-name-when-on={documentIcon}
                                                    icon-name-when-off={documentIcon}
                                                    selected={isSelected}
                                                    icon-position="left"
                                                    variant={documentVariant}
                                                    onclick={selectedDocuments}></lightning-button-stateful>
                                                    <p class="slds-p-horizontal_small">
                                                        <text>This document can be used in the following states {temp.Used_in_States__c}</text><br>
                                                        
                                                        <text><b>Required Signers:</b>&nbsp;{temp.Required_Signers__c}</text>
                                                       
                                                                                
                                                    </p>
                                                    <div slot="footer">
                                                        <lightning-badge label={temp.Status__c} class="slds-theme_success"></lightning-badge> &nbsp; <lightning-badge lwc:if={temp.Requires_Data_Validation__c} label="Validation Required" class="slds-theme_error"></lightning-badge>
                                                        &nbsp; <lightning-badge lwc:if={temp.stateSpecific} label="State Specific" class="stateBadge"></lightning-badge>
                                                    </div>
                                                </lightning-card>
                                                </div>
                                            </template>
                                        </lightning-layout-item>
                                </lightning-layout>   
                            </lightning-card>                                     
                        </div>
                   
                        <!--CONFIRM-->
                        <div class="confirm slds-hide">
                            <lightning-layout lwc:if={templateInfo.Requires_Data_Validation__c} multiple-rows="true">
                                <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="6">
                                    <lightning-card title="Plaintiff Information" icon-name="standard:contact">
                                        <lightning-layout class="slds-box" multiple-rows="true">
                                            
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="6">
                                                <lightning-input type="text" data-field="FirstName" label="First Name" onchange={handlePlaintiffFirst} value={recordData.Plaintiff_Case__r.Plaintiff_First_Name__c}></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="6">
                                                <lightning-input type="text" data-field="LastName" label="Last Name" onchange={handlePlaintiffLast} value={recordData.Plaintiff_Case__r.Plaintiff_Last_Name__c}></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                <lightning-input type="email" data-field="Email" label="Email" onchange={handlePlaintiffEmail} value={recordData.Plaintiff_Case__r.Plaintiff_Email__c}></lightning-input>
                                            </lightning-layout-item>
                                                
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                <lightning-input-address
                                                street-label="Street"
                                                city-label="City"
                                                province-label="State"
                                                postal-code-label="Zip/Postal Code" 
                                                street={recordData.Plaintiff_Case__r.Plaintiff_Street_Address_1__c}
                                                city={recordData.Plaintiff_Case__r.Plaintiff_City__c}
                                                province={recordData.Plaintiff_Case__r.Plaintiff_State__c}
                                                postal-code={recordData.Plaintiff_Case__r.Plaintiff_Zip__c}
                                                onchange={handleAddressChange}
                                                ></lightning-input-address>
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </lightning-card>
                                </lightning-layout-item>

                                <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="6">
                                    <lightning-card title="Attorney Information" value="2" icon-name="standard:employee_contact"> 
                                        <lightning-layout class="slds-box" multiple-rows="true">
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                <lightning-input type="text" data-field="AttorneyFirst" label="First Name"  value={recordData.Plaintiff_Case__r.Attorney__r.FirstName} disabled></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                <lightning-input type="text" data-field="AttorneyLast" label="Last Name"  value={recordData.Plaintiff_Case__r.Attorney__r.LastName} disabled></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                <lightning-input class="attEm" type="email" data-field="AttorneyEmail" onchange={handleAttEmail} label="Email" value={recordData.Plaintiff_Case__r.Attorney__r.Email}></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                <lightning-input type="text" data-field="LawFirm" label="Law Firm" value={recordData.Plaintiff_Case__r.Law_Firm__r.Name} disabled></lightning-input>
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </lightning-card>
                                </lightning-layout-item>
                                    
                                <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                    <lightning-card title="Advance Information" value="3" icon-name="standard:budget"> 
                                        <lightning-layout class="slds-box" multiple-rows="true">
                                                
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="3">
                                                <lightning-input type="number" data-field="RequestedAmount" label="Amount" onchange={handleRequestedAmount} value={recordData.Requested_Amount__c} formatter="currency" step="0.01"></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="3">
                                                <lightning-input type="date" data-field="DisburseDate" label="Disburse/Deploy Date" onchange={handleDisburseDate} value={recordData.Distribution_Disbursement_Date__c}></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="3">
                                                <lightning-input type="number" data-field="OriginationFee" label="Origination Fee" onchange={handleOrigination} value={recordData.Origination_Fee_Pct__c} formatter="percent" step="0.01"></lightning-input>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="3">
                                                <lightning-input type="number" data-field="MonthlyUsageFee" label="Usage Fee" onchange={handleMonthlyFee} value={recordData.Monthly_Usage_Fee_Pct__c} formatter="percent" step="0.01"></lightning-input>
                                            </lightning-layout-item>
                                            
        
                                            <lightning-layout-item padding="around-x-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                                
                                                    <table class="styled-table">
                                                        <thead>
                                                            <tr>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate" title="After Month">After</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate" title="Exit Date">Exit Date</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate" title="APR">APR</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate" title="Balance Owed">Balance Owed</div>
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <template for:each={advanceLines} for:item="lines">
                                                                <tr key={lines.Id}>
                                                                    <td>{lines.After_Month__c} &nbsp; Months</td>
                                                                    <td>{lines.Case_Exit_Date__c}</td>
                                                                    <td><lightning-formatted-number format-style="percent" maximum-fraction-digits="2" value={lines.Annualized_APR__c}></lightning-formatted-number></td>
                                                                    <td><lightning-formatted-number format-style="currency" maximum-fraction-digits="2" currency-code="USD" value={lines.Balanced_Owed__c}></lightning-formatted-number></td>
                                                                </tr>
                                                            </template>
                                                        </tbody>
                                                    </table>
                                                
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </lightning-card>
                                </lightning-layout-item>
                            </lightning-layout>
                        </div>

                        <!--OPTIONS-->
                        <div class="options slds-hide">

                        </div>

                        <!--VALIDATING-->
                        <div class="validating slds-hide">
                            <lightning-layout multiple-rows="true">
                                <lightning-layout-item class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                    <div if:true={showValidateSpinner}>
                                        <span class="loader"></span>
                                    </div>
                                    </lightning-layout-item>

                                    <lightning-layout-item lwc:if={validateError} padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                        <text  class="errorMessage">{validateErrorMessage}</text><br> 
                                    </lightning-layout-item>

                                    <lightning-layout-item lwc:else class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                        <text class="stepSubHeaderInfoText"></text> 
                                    </lightning-layout-item>

                                    <lightning-layout-item lwc:if={validateError} class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                        
                                    
                                        <table class="validate-table">
                                            <thead>
                                               <tr>
                                                  <th class="" scope="col">
                                                      <div class="slds-truncate" title="After Month"></div>
                                                  </th>    
                                                  <th class="" scope="col">
                                                          <div class="slds-truncate" title="After Month">Error</div>
                                                      </th>
                                                      <th class="" scope="col">
                                                          <div class="slds-truncate" title="Balance Owed">Resolution</div>
                                                      </th>
                                                  
                                               </tr>
                                            </thead>
                                              <tbody>
                                               <template for:each={errorData} for:item="verror">
                                                   <tr key={verror.Id}>
                                                      <td><lightning-icon icon-name={verror.icon} variant="error" size="small"></lightning-icon></td>
                                                       <td>{verror.message}</td>
                                                       <td>{verror.recommend}</td>
      
                                                   </tr>
                                              </template>
                                          </tbody>
                                      </table>
                                    </lightning-layout-item>
                                    
                            </lightning-layout>
                        </div>

                        <!--GENERATING-->
                        <div class="generating slds-hide">
                            <lightning-layout multiple-rows="true">                
                                <lightning-layout-item class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                    <div if:true={showGenerateSpinner}>
                                        <span class="generate"></span>
                                    </div> 
                                    
                                </lightning-layout-item>
                                <lightning-layout-item lwc:if={generateError} class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                    <text class="errorMessage">{generateErrorMessage}</text>
                                </lightning-layout-item>
                                <lightning-layout-item lwc:else class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                    <text class="stepSubHeaderInfoText">Your document is being generated</text>                                                        
                                </lightning-layout-item>
                                <lightning-layout-item lwc:if={generateError} class="center-container" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                        
                                    
                                    <table class="validate-table">
                                        <thead>
                                           <tr>
                                              <th class="" scope="col">
                                                  <div class="slds-truncate" title="After Month"></div>
                                              </th>    
                                              <th class="" scope="col">
                                                      <div class="slds-truncate" title="After Month">Error</div>
                                                  </th>
                                                  <th class="" scope="col">
                                                      <div class="slds-truncate" title="Balance Owed">Resolution</div>
                                                  </th>
                                              
                                           </tr>
                                        </thead>
                                          <tbody>
                                           <template for:each={generateErrorData} for:item="verror">
                                               <tr key={verror.Id}>
                                                  <td><lightning-icon icon-name={verror.icon} variant="error" size="small"></lightning-icon></td>
                                                   <td>{verror.message}</td>
                                                   <td>{verror.recommend}</td>
  
                                               </tr>
                                          </template>
                                      </tbody>
                                  </table>
                                </lightning-layout-item>
                            </lightning-layout>
                        </div>

                        <!--REVIEW-->
                        <div class="review slds-hide">
                            <!--DOCUMENT PREVIEW-->
                            
                            <lightning-card>
                                

                                <lightning-layout multiple-rows="true">
                                    <lightning-layout-item  padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">

                                        <lightning-card>
                                            <lightning-layout multiple-rows="true">
                                                <lightning-layout-item  padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="2">
                                                    <img src={successIconpng}>
                                                </lightning-layout-item>
                                                <lightning-layout-item class="slds-align-middle" padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="10">
                                                    <text class="successMessage">Your document has generated successfully.</text> <br>
                                                    <text class="successSubMessage">Please click on the <b>Open Document</b> button below to view/modify</text>
                                                </lightning-layout-item>
                                                <lightning-layout-item class="slds-align-middle" padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="10">
                                                    <text>Note: Do not close this popup, if you make changes, please return here to finish out the process!</text>
                                                </lightning-layout-item>
                                                <template if:true={showBoxSpinner}>
                                                    <!-- <div class="backdrop"></div> -->
                                                    <div class="center-container">
                                                        <!--<span class="boxLoader slds-align_absolute-center"></span>-->
                                                        <lightning-spinner class="load" alternative-text="Uploading the file..." size="medium">   
                                                        </lightning-spinner>
                                                        <text class="stepSubHeaderInfoText centered-spinner-text">Uploading File To Box...</text>
                                                    </div>
                                                </template>
                                            </lightning-layout>
                                            <p slot="footer">
                                                <lightning-button label="Open Document" variant="brand" onclick={openFile}></lightning-button>
                                            </p>

                                        </lightning-card>

                                    </lightning-layout-item>
                                </lightning-layout>
                            </lightning-card>
                        </div>


                        <!--COMPLETED-->
                        <div class="complete slds-hide">
                            <lightning-layout multiple-rows="true">
                                <lightning-layout-item class="slds-grid_horizontal-align-center" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                    <div class="slds-align_absolute-center">
                                        <img  src={completeIcon}>
                                    </div>
                                </lightning-layout-item>
                                <lightning-layout-item lwc:if={templateInfo.Requires_Data_Validation__c} class="slds-grid_horizontal-align-center" padding="around-small" size="12" small-device-size="1" medium-device-size="4" large-device-size="12">
                                    <lightning-card  variant="Narrow"  title={fileName} icon-name={extensionIcon}>
                                        
                                        <text class="subData" slot="actions"><b>{documentStatus}</b></text>
                                        <p class="slds-p-horizontal_small">
                                            <text class="approvalHeading">Your document has been generated and sent for review/approval prior to sending out for signature</text><br>
                                            <text class="approvalSubHeading">You will receive a notification once your document has been reviewed and/or approved.</text>
                                        </p>
                                        <p slot="footer">
                                     
                                        </p>
                                    </lightning-card>
                                </lightning-layout-item> 
                                <lightning-layout-item lwc:else class="slds-grid_horizontal-align-center" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                    <text class="completeHeading slds-align_absolute-center">COMPLETE</text><br>
                                    <text class="completeData slds-align_absolute-center">Document Generation Complete, please close out of modal</text>
                                </lightning-layout-item>
                            </lightning-layout>
                        </div>


                    </lightning-layout-item>
                </lightning-layout>
            </lightning-layout-item>

        </lightning-layout>

        <template lwc:if={launchBox}>
            <div class="demo-only" style="height: 640px;">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-14" class="slds-modal slds-modal_medium slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header warning">
                            <div class="slds-text-heading_large">REQUEST SIGNATURE</div> 
                        </header>
                        
                        <div class="genLayout slds-modal__content slds-p-around_large slds-is-relative" id="modal-content-id-116">
                            <lightning-layout  multiple-rows="true">
                               
                                <!--STEP HEADER-->
                               
                                   
                            <lightning-layout-item padding="around-small" size="12" small-device-size="12" medium-device-size="12" large-device-size="12">
                                <lightning-progress-indicator type="path" current-step={selectedStep} variant="base">
                                    <lightning-progress-step label="Select Recipients" value="Step1">
                                    </lightning-progress-step>
                                    <lightning-progress-step label="Options and Message"  value="Step2">
                                    </lightning-progress-step>
                                    <lightning-progress-step label="Review" value="Step3">
                                    </lightning-progress-step>
                                    <lightning-progress-step label="Complete" value="Step4">
                                    </lightning-progress-step>
                                </lightning-progress-indicator>
                            </lightning-layout-item>
    
                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                            <text class="signHeader">Document Name: &nbsp;</text><br><text class="signSubHeader">{documentName}</text>                        
                            </lightning-layout-item>
    
                                <!--CONTENT AREA-->
                                <lightning-layout-item  padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                   
                                    <div class="stepOne">
                                        <c-l-i-s-recipient-table-l-w-c preset-signers={sendPresets} onsignerdata={handleSigners} onsignertable={setSignerTable} current-record-id={documentID}></c-l-i-s-recipient-table-l-w-c>
    
                                        <!--<lightning-layout  multiple-rows="true">
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                <h2 class="slds-section-title--divider confirmInfoHeaders">Recipients</h2>
                                                <lightning-layout class="slds-box" multiple-rows="true">
                                                    <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                        
                                                            <c-l-i-s-recipient-table-l-w-c preset-signers={sendPresets} onsignerdata={handleSigners} current-record-id={documentID}></c-l-i-s-recipient-table-l-w-c>
                                                           
                                                    </lightning-layout-item> 
                                                </lightning-layout>
                                            </lightning-layout-item>
                                        </lightning-layout>-->
                                    </div>
    
                                    <div class="stepTwo slds-hide">
                                        <lightning-layout  multiple-rows="true">
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="6">
                                                <text class="signingHeader">SIGNING OPTIONS</text>
                                                <lightning-layout class="slds-box" multiple-rows="true">
                                                    <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="4">
                                                        <lightning-combobox disabled name="preparationNeeded" label="Preparation Needed?" options={preparationOptions} value="yes" onchange={handlePreparationChange}></lightning-combobox>
                                                    </lightning-layout-item>
                                                    <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="4">
                                                        <lightning-combobox disabled name="sendReminders" label="Send Reminders?" options={reminderOptions} value="yes" onchange={handleReminderChange}></lightning-combobox>
                                                    </lightning-layout-item>
                                                    <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="4">
                                                       <lightning-input disabled type="number" variant="label-stacked" label="Days Valid?"></lightning-input>
                                                    </lightning-layout-item>
                                                </lightning-layout>
                                            </lightning-layout-item>
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="6">
                                                <text class="signingHeader">MESSAGE</text>
                                                        <lightning-layout class="slds-box" multiple-rows="true">
                                                            
                                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                                <lightning-input type="text" label="Subject" value={emailSubject} onchange={handleSubjectChange}></lightning-input>
                                                            </lightning-layout-item>
                                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                                <lightning-textarea label="Message" value={emailMessage} onchange={handleMessageChange}></lightning-textarea>
                                                            </lightning-layout-item>
                                                        </lightning-layout>
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </div>
    
                        
                                    <div class="stepThree slds-hide">
                                        <lightning-layout  multiple-rows="true">
                                            <template if:true={showReviewScreen}>                                       
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="6">
                                                <text class="signingHeader">REVIEW RECIPIENTS</text><br>
                                              
                                                     <table class="styled-table">
                                                          <thead>
                                                             <tr>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate" title="After Month">Type</div>
                                                                </th>    
                                                                <th class="" scope="col">
                                                                        <div class="slds-truncate" title="After Month">Email</div>
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="Balance Owed">Role</div>
                                                                    </th>
                                                                
                                                             </tr>
                                                          </thead>
                                                            <tbody>
                                                             <template for:each={signerTable} for:item="lines">
                                                                 <tr key={lines.Id}>
                                                                    <td>{lines.typeLabel}</td>
                                                                     <td>{lines.email}</td>
                                                                     <td>{lines.roleLabel}</td>
                    
                                                                 </tr>
                                                            </template>
                                                        </tbody>
                                                    </table>
                                                  
                                            </lightning-layout-item>
    
                                            <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="6">
                                                <text class="signingHeader">EMAIL MESSAGE</text><br>
    
                                                <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                    <p><strong>Email Subject: &nbsp;</strong>{emailSubject}</p>
                                                    
                                                </lightning-layout-item>
                                                <lightning-layout-item padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                    <p><strong>Email Message: &nbsp;</strong>{emailMessage}</p>
                                                       
                                                </lightning-layout-item>
    
                                                <div class="slds-spinner_container custom-spinner-container" if:true={showSpinner}>
                                                    <div role="status" class="slds-spinner slds-spinner_medium">
                                                        <span class="slds-assistive-text">{spinnerMessage}</span>
                                                        <div class="slds-spinner__dot-a"></div>
                                                        <div class="slds-spinner__dot-b"></div>
                                                        <p if:true={spinnerMessage} class="custom-spinner-message">{spinnerMessage}</p>
                                                    </div>
                                                </div>
                                            
                                                 </lightning-layout-item>
                                            </template>
                                        </lightning-layout>
                                    </div>
    
                                    <div class="stepFour slds-hide">
                                        <lightning-layout multiple-rows="true">
                                            <lightning-layout-item class="slds-grid_horizontal-align-center" padding="around-small" size="12" small-device-size="1" medium-device-size="12" large-device-size="12">
                                                <text class="subHeadings">COMPLETE</text><br>
                                                <text class="subData">You may now close out of this Modal.</text>
                                            </lightning-layout-item>
                                        </lightning-layout>
                                    </div>
                                    
                                </lightning-layout-item>
    
                            </lightning-layout>
                   </div>
                <footer class="slds-modal__footer">
                    <lightning-layout>
                        <lightning-layout-item padding="around-small" class="slds-text-align_right" size="12"> 
                                         
                            <lightning-button class="slds-m-left_x-small" variant="destructive" icon-name="utility:close" icon-position="left" label="Cancel" onclick={closeBoxSign}></lightning-button>
                            <lightning-button if:true={showSignerPrevious} class="slds-m-left_x-small" variant="brand-outline" icon-name="utility:chevronleft" icon-position="left" label="Back" onclick={handleBoxPrevious}></lightning-button>
                            <lightning-button class="slds-m-left_x-small" variant="brand-outline" icon-name="utility:chevronright" icon-position="right" label={proceedBoxNextLabel} onclick={handleBoxNext}></lightning-button>
    
                        </lightning-layout-item>
                    </lightning-layout>
    
                </footer>
    
                </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </template>
      
    </lightning-modal-body>
    <lightning-modal-footer>
   
        <!--<lightning-progress-indicator current-step={currentTabValue} type="base" variant="base">
            <template for:each={stepsArray} for:item="step">
                <lightning-progress-step label={step.label} value={step.value} key={step.label}></lightning-progress-step>
            </template>
        </lightning-progress-indicator>-->
        
       
        <lightning-button-group>
            <lightning-button lwc:if={showPrevious} disabled={disablePrevious} variant="brand-inverse" icon-name="utility:chevronleft" icon-position="left" label="Previous" onclick={handlePrevious}></lightning-button>
            <lightning-button disabled={disableNext} variant="brand" icon-name="utility:chevronright" icon-position="right" label={proceedButtonLabel} onclick={handleNext}></lightning-button>
        </lightning-button-group>              
        <!--<lightning-button if:false={generated} class="slds-m-left_x-small" variant="destructive" icon-name="utility:close" icon-position="left" label="Cancel" onclick={closeDocuments}></lightning-button>-->
    </lightning-modal-footer>
    
    </template>